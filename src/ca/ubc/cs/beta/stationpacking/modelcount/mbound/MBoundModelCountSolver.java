package ca.ubc.cs.beta.stationpacking.modelcount.mbound;

import java.io.FileNotFoundException;
import java.util.HashMap;
import java.util.HashSet;
import java.util.Map;
import java.util.Set;

import org.apache.commons.math3.util.Pair;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

import ca.ubc.cs.beta.stationpacking.base.Station;
import ca.ubc.cs.beta.stationpacking.base.StationPackingInstance;
import ca.ubc.cs.beta.stationpacking.execution.EncodedInstanceToCNFConverter;
import ca.ubc.cs.beta.stationpacking.execution.parameters.solver.sat.ClaspLibSATSolverParameters;
import ca.ubc.cs.beta.stationpacking.facade.datamanager.data.DataManager;
import ca.ubc.cs.beta.stationpacking.facade.datamanager.data.ManagerBundle;
import ca.ubc.cs.beta.stationpacking.modelcount.IModelCountSolver;
import ca.ubc.cs.beta.stationpacking.modelcount.mbound.algorithm.MBoundAlgorithm;
import ca.ubc.cs.beta.stationpacking.modelcount.mbound.base.MBoundResult;
import ca.ubc.cs.beta.stationpacking.modelcount.mbound.base.MBoundResult.MBoundResultType;
import ca.ubc.cs.beta.stationpacking.modelcount.mbound.parameters.MBoundParameters;
import ca.ubc.cs.beta.stationpacking.solvers.sat.base.CNF;
import ca.ubc.cs.beta.stationpacking.solvers.sat.cnfencoder.ISATEncoder;
import ca.ubc.cs.beta.stationpacking.solvers.sat.cnfencoder.SATCompressor;
import ca.ubc.cs.beta.stationpacking.solvers.sat.solvers.ISATSolver;
import ca.ubc.cs.beta.stationpacking.solvers.sat.solvers.nonincremental.ClaspSATSolver;

import com.google.common.collect.Lists;

/**
 * Model count solver based on {@link MBoundAlgorithm}.
 * @author tqichen
 */
public class MBoundModelCountSolver implements IModelCountSolver {

    private static final Logger log = LoggerFactory.getLogger(MBoundModelCountSolver.class);

    /**
     * A dummy channel which has no interferences associated to it.
     */
    private static final int HAPPYCHANNEL = 0;

    private final ISATEncoder fSATEncoder;
    private final ISATSolver fSATSolver;
    private final int fSATSolverCutoff;

    /**
     * @param aSATEncoder - an encoder which encodes station packing instances into CNFs.
     * @param aSATSolver - a SAT solver which solves CNFs.
     * @param aSATSolverCutoff - allocated time (s) for each SAT solving instance.
     * @param aTerminationCriterion - the termination criterion for a single SAT solver execution (usually cutoff time based).
     */
    public MBoundModelCountSolver(ISATEncoder aSATEncoder, ISATSolver aSATSolver, int aSATSolverCutoff) {
        fSATEncoder = aSATEncoder;
        fSATSolver = aSATSolver;
        fSATSolverCutoff = aSATSolverCutoff;
    }

    @Override
    public Double countSatisfiablePackings(StationPackingInstance aInstance, long aSeed) {

        // Add a non-interference channel to every station.
        // This allows us to find solutions which only contain a subset of the stations.
        // With the exception of every station choosing the happy channel, every solution is valid.

        Map<Station, Set<Integer>> domains = new HashMap<Station, Set<Integer>>(aInstance.getDomains());
        for (Station s : domains.keySet()) {
            Set<Integer> channels = new HashSet<Integer>(domains.get(s));
            channels.add(HAPPYCHANNEL);
            domains.put(s, channels);
        }

        StationPackingInstance instanceWithHappyChannels = new StationPackingInstance(domains, aInstance.getPreviousAssignment());

        CNF encodedInstance = fSATEncoder.encode(instanceWithHappyChannels).getFirst();

        Pair<Double, Double> lowerUpperBounds = getLowerAndUpperBounds(instanceWithHappyChannels, encodedInstance, aSeed);

        Double lower = lowerUpperBounds.getFirst();
        Double upper = lowerUpperBounds.getSecond();

        // Minus one for the empty station subset solution.

        if (Double.isNaN(lower) && Double.isNaN(upper)) {
            return null;

        } else if (Double.isNaN(lower)) {
            return Math.floor(upper)-1;

        } else if (Double.isNaN(upper)) {
            return Math.floor(lower)-1;

        } else {
            return Math.floor((lower + upper) / 2.0)-1;

        }
    }

    @Override
    public Double countSatisfiablePackingsContainingStation(StationPackingInstance aInstance, Station aStation, long aSeed) {

        // Add a non-interference channel to every station except the target station.

        Map<Station, Set<Integer>> domains = new HashMap<Station, Set<Integer>>(aInstance.getDomains());
        for (Station s : domains.keySet()) {
            Set<Integer> channels = new HashSet<Integer>(domains.get(s));
            if (!s.equals(aStation)) {
                channels.add(HAPPYCHANNEL);
            }
            domains.put(s, channels);
        }

        StationPackingInstance instanceWithHappyChannels = new StationPackingInstance(domains, aInstance.getPreviousAssignment());

        CNF encodedInstance = fSATEncoder.encode(instanceWithHappyChannels).getFirst();

        Pair<Double, Double> lowerUpperBounds = getLowerAndUpperBounds(instanceWithHappyChannels, encodedInstance, aSeed);

        Double lower = lowerUpperBounds.getFirst();
        Double upper = lowerUpperBounds.getSecond();


        if (Double.isNaN(lower) && Double.isNaN(upper)) {
            return null;

        } else if (Double.isNaN(lower)) {
            return Math.floor(upper);

        } else if (Double.isNaN(upper)) {
            return Math.floor(lower);

        } else {
            return Math.floor((lower + upper) / 2.0);

        }

    }

    private Pair<Double, Double> getLowerAndUpperBounds(StationPackingInstance aStationPackingInstance, CNF aCNF, Long aSeed) {
        // Construct MBound parameters.
        // TODO: make smarter.

        log.debug("CNF with {} clauses.", aCNF.size());
        log.debug("CNF with {} variables.", aCNF.getVariables().size());

        int n = aStationPackingInstance.getStations().size();

        boolean foundLower = false;
        boolean foundUpper = false;

        Double lowerBound = Double.NaN;
        Double upperBound = Double.NaN;

        int ilow = 2;

        while (!foundLower) {
            int s = (int) (n - ilow);
            ilow = 2 * ilow;

            MBoundParameters parameters = new MBoundParameters(7, s, 20, 0.1, 1.5);
            MBoundResult result = MBoundAlgorithm.solve(parameters, aCNF, fSATSolver, fSATSolverCutoff, aSeed);

            log.trace("With s={}, result={}.", s,result);

            if (result.getResultType().equals(MBoundResultType.LOWERBOUND)) {
                lowerBound = result.getBound();
                foundLower = true;
            } else if (result.getResultType().equals(MBoundResultType.UPPERBOUND)) {
                upperBound = result.getBound();
                foundUpper = true;
            }
        }

        int ihigh = 1;

        while (!foundUpper) {
            int s = (int) (n + ihigh);
            ihigh = 2 * ihigh;

            MBoundParameters parameters = new MBoundParameters(5, s, 20, 0.1, 1.5);
            MBoundResult result = MBoundAlgorithm.solve(parameters, aCNF, fSATSolver, fSATSolverCutoff, aSeed);

            log.trace("With s={}, result={}.", s,result);

            if (result.getResultType().equals(MBoundResultType.LOWERBOUND)) {
                lowerBound = result.getBound();
                foundLower = true;
            } else if (result.getResultType().equals(MBoundResultType.UPPERBOUND)) {
                upperBound = result.getBound();
                foundUpper = true;
            }
        }
        
        log.debug("Found lower and upper bounds ({},{}).", lowerBound, upperBound);

        return new Pair<Double,Double>(lowerBound, upperBound);
    }

    @Override
    public void interrupt() throws UnsupportedOperationException {
        throw new UnsupportedOperationException();
    }

    @Override
    public void notifyShutdown() {
        fSATSolver.notifyShutdown();
    }
    
    
    @SuppressWarnings("javadoc")
    public static void main(String[] args) throws FileNotFoundException {

        String UHF_only_sql_string = "021814SC3M_1103;26;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_4;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_5;24;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1092;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_10;24;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_11;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1090;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1116;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1119;28;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1113;22;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_20;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1111;27;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1110;16;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_31;18;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_34;16;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1131;25;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_37;30;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1129;28;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_42;16;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1126;24;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_43;31;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1127;20;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_41;23;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1125;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1122;31;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1123;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_44;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1121;26;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_49;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_48;21;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1147;25;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1144;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1143;14;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_63;20;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1138;18;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1033;31;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1035;17;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1037;14;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_65;30;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_67;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_76;17;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1025;25;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_79;24;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_73;24;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1030;19;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_75;31;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_84;17;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1051;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_86;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1053;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_80;31;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1055;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_93;14;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_92;22;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_91;22;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1066;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_101;21;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1070;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_97;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1058;21;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1059;24;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1063;27;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1083;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1082;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_117;31;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1080;25;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1087;18;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1085;18;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_112;27;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1084;16;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_125;27;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_124;29;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1079;19;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_123;21;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1078;24;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_121;28;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1221;28;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_137;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_2067;16;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_2066;17;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1222;18;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_138;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1217;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_141;22;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_2073;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1231;29;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1230;31;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_133;23;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_2076;21;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_132;30;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_134;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_2048;29;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1236;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_2049;20;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1232;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_2053;24;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_157;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_2054;16;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1234;28;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_144;16;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_2056;21;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_2058;23;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1240;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_148;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_2061;24;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_149;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_2063;19;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_2099;15;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1253;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_2103;24;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_2102;27;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_174;19;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1249;27;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_2101;29;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_2105;19;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_160;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_2111;28;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_2110;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_166;30;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1270;22;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1271;16;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_187;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1268;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_2080;26;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1269;24;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1264;27;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1265;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_2085;28;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_2090;30;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_2091;31;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1277;16;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_2089;25;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_177;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_2094;23;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_2095;30;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_183;20;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_205;28;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_2135;30;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_207;29;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_2134;30;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_2128;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_202;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1161;14;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1160;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1163;28;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_2143;23;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1162;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_2142;22;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_2137;20;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_192;22;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_2136;29;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1167;29;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1166;19;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1169;15;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_222;30;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1170;31;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1171;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_2119;28;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_216;30;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1173;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_2113;18;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_2114;29;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_219;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1175;20;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1176;17;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_214;23;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_208;28;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_2122;25;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1183;30;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1187;30;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_2167;19;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1186;23;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_2164;26;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_235;14;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1189;14;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_2161;25;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1188;31;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_231;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_2173;29;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_228;28;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_2172;19;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1199;17;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_2170;30;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_225;14;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1196;26;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_254;21;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_255;26;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_2151;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1203;31;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_2149;16;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1201;14;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_250;14;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_2146;29;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_251;19;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1207;31;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_2144;21;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1204;20;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1205;15;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1210;22;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1211;17;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_2156;19;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1208;25;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_245;20;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_2157;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1209;23;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_242;15;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1214;29;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_243;24;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_2155;26;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1215;21;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_2152;29;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1212;16;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_241;26;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_275;31;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_273;27;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1372;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1370;18;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1368;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_276;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_283;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1367;17;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1366;25;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_281;23;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_287;27;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1363;28;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_286;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1361;26;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1358;31;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_259;27;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1359;31;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_262;31;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1352;20;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_261;16;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1350;27;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_267;19;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_264;29;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_265;15;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1347;24;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1407;23;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_306;18;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1400;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1396;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_312;23;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_315;25;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1398;18;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_316;19;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1395;26;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_288;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1389;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_289;18;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1390;25;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1391;18;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1386;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_294;22;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_295;31;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1380;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1377;22;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1378;17;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_302;28;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1379;30;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_303;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_343;16;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_342;23;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1305;14;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1304;14;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_336;17;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_351;26;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_350;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1300;22;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1291;19;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1288;31;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_325;18;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1289;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_323;24;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_320;19;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_321;14;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1293;21;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1282;30;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1280;28;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_333;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1286;17;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_328;27;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1285;17;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_373;24;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1337;23;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_375;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_374;23;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1338;31;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1341;31;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_368;22;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1343;14;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1329;20;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_378;31;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1334;29;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_357;22;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1321;30;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1322;24;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_359;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_352;17;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_365;18;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_366;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_360;26;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_361;23;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1317;24;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_363;25;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1319;18;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_410;17;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_414;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_415;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_402;18;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_400;28;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1501;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_407;25;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_394;30;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1478;27;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1475;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1474;26;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_386;26;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1485;30;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1484;28;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_384;16;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_391;21;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_389;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1481;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_388;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_441;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_444;28;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_445;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_434;21;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1534;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1535;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_436;24;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1528;21;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1530;14;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1511;19;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1517;31;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_419;27;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1518;20;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1513;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_422;15;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_478;30;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_479;24;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1427;28;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1424;31;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1430;15;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_475;28;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_472;26;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1429;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1434;25;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1435;14;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1432;17;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_469;23;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1438;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_466;23;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_467;14;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_465;30;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_461;15;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1415;15;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1414;15;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1413;22;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_457;14;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1419;29;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_455;17;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_454;24;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1417;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_453;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_452;31;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1423;29;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_451;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_450;23;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1421;24;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_448;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1420;30;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1456;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_509;28;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1459;15;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_511;25;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_504;19;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1462;25;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1463;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1464;23;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1466;28;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1468;19;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_492;14;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_494;19;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1445;19;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_489;31;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1444;24;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1447;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_487;16;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1450;27;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_486;27;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1453;29;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_481;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1452;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1454;16;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_551;15;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1643;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_548;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1641;27;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_546;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1646;26;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_545;14;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1645;29;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_559;19;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_556;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_557;28;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1633;26;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1638;27;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1639;25;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_553;21;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_566;28;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1656;21;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1663;16;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_562;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_560;14;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_575;25;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1653;23;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1652;22;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_516;31;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1610;22;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1611;24;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_519;28;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1613;27;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1614;24;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_525;25;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_521;25;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_522;21;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_535;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_534;20;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1629;14;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_529;30;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1617;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_541;22;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_540;31;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1619;31;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_543;24;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1621;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_537;24;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1620;15;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_539;20;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1582;29;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_608;30;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1581;30;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1579;15;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1576;22;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_612;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_613;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1574;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_618;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1573;20;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_617;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_623;29;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1568;21;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_620;26;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_626;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_630;15;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_634;28;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_633;20;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_637;25;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1584;29;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_577;18;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1550;19;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_578;25;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_581;24;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_584;15;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1540;16;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_586;18;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1543;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_587;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_589;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_590;27;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1565;25;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_593;15;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_597;22;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1560;17;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1563;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_599;29;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1562;17;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_600;16;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1558;27;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1553;23;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1555;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1763;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_683;29;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_682;14;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1764;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_678;29;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1769;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1774;27;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_672;21;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_700;23;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1777;14;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1782;18;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_696;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_697;31;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1781;15;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1786;27;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_693;31;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_690;26;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1790;28;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_691;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1788;30;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1789;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_653;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_652;26;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_649;14;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1732;21;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_651;31;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_645;28;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_644;15;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1739;18;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1738;26;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_646;31;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_640;24;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_642;25;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_669;20;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_670;18;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1747;18;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_664;28;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1749;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_666;20;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_667;23;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_660;14;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1753;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1754;18;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_662;28;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_656;18;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_659;19;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_746;17;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1701;21;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_744;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1699;16;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_751;31;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1697;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_738;20;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1709;23;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_737;22;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_743;31;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1706;19;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_742;31;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1705;14;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_741;15;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1718;19;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1714;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1713;20;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1727;22;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1724;27;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_752;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_753;28;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_758;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_759;21;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_757;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1669;26;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1668;19;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_716;20;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_718;31;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_704;30;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1678;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_710;29;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1685;30;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_729;27;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1686;21;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_730;24;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1687;15;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1681;23;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_734;25;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1683;28;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_735;22;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_722;25;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1695;25;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1688;31;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_727;21;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_821;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_822;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_817;25;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_816;23;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1918;22;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_831;15;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1911;27;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1910;16;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1896;22;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_805;20;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1900;31;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_802;21;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_814;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_811;28;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1895;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1883;30;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_790;22;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1881;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_784;21;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_799;16;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1874;14;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_797;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_796;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1866;25;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_775;22;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1864;24;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1871;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1869;25;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_778;23;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_779;29;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_776;25;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1860;20;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1861;22;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1852;27;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1855;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1854;31;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_882;15;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_885;18;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_887;30;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_888;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_893;17;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_892;24;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1843;25;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1842;19;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_864;31;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_865;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1839;25;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_868;31;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1835;26;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_872;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1829;15;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_874;17;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1831;20;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1826;23;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_851;22;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_850;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1820;26;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1819;29;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1818;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1815;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_859;26;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_858;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_856;21;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1811;30;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_863;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1810;16;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_862;21;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_860;22;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_834;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_833;20;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1802;21;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1803;27;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1801;29;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_842;27;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1799;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_841;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1794;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_846;29;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_956;28;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_958;16;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_2035;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_2037;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_2038;23;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_954;23;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_955;28;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_2042;15;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_2043;22;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_2045;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_2017;27;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_941;19;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_940;28;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_2019;14;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_2021;28;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_2023;15;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_938;14;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_932;19;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_935;21;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_2026;23;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_2029;14;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_928;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_2030;25;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_2002;26;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_2003;29;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_927;17;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_2000;21;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_2001;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_921;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_916;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_915;29;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_912;26;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_2013;24;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_909;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_908;22;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1984;27;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_907;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1990;31;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1989;19;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_905;17;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1988;21;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_904;19;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_903;27;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_902;27;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_901;24;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1992;23;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1997;17;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1016;18;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1972;30;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1017;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1973;17;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1974;22;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1021;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1022;23;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1980;28;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1982;28;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1976;18;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1014;27;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1015;16;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1957;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1000;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1003;26;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1002;30;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1952;19;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1007;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_993;26;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1965;27;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_992;17;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_995;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_996;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_984;26;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_991;22;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_978;29;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_976;29;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1946;19;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_980;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1945;30;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1926;29;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1924;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_975;22;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1922;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_973;21;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1935;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_962;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1933;29;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1932;26;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_960;17;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1931;-1;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1930;16;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_966;26;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_1929;23;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30_964;17;14,15,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30";
        //String VHF_only_sql_string = "021814SC3M_1728;-1;7,8,9,10,11,12,13_130;-1;7,8,9,10,11,12,13_1795;-1;7,8,9,10,11,12,13_708;-1;7,8,9,10,11,12,13_1673;-1;7,8,9,10,11,12,13_970;-1;7,8,9,10,11,12,13_1548;-1;7,8,9,10,11,12,13_1294;-1;7,8,9,10,11,12,13_1746;-1;7,8,9,10,11,12,13_1939;-1;7,8,9,10,11,12,13_917;-1;7,8,9,10,11,12,13_1878;-1;7,8,9,10,11,12,13_1559;-1;7,8,9,10,11,12,13_1880;-1;7,8,9,10,11,12,13_922;-1;7,8,9,10,11,12,13_1052;-1;7,8,9,10,11,12,13_1696;-1;7,8,9,10,11,12,13_1057;-1;7,8,9,10,11,12,13_484;-1;7,8,9,10,11,12,13_1509;-1;7,8,9,10,11,12,13_1575;-1;7,8,9,10,11,12,13_1384;-1;7,8,9,10,11,12,13_1193;-1;7,8,9,10,11,12,13_171;-1;7,8,9,10,11,12,13_878;-1;7,8,9,10,11,12,13_756;-1;7,8,9,10,11,12,13_1332;-1;7,8,9,10,11,12,13_310;-1;7,8,9,10,11,12,13_502;-1;7,8,9,10,11,12,13_1591;-1;7,8,9,10,11,12,13_2039;-1;7,8,9,10,11,12,13_631;-1;7,8,9,10,11,12,13_443;-1;7,8,9,10,11,12,13_1149;-1;7,8,9,10,11,12,13_317;-1;7,8,9,10,11,12,13_894;-1;7,8,9,10,11,12,13";
        
        // Get station packing instance.
        String interferencesConfigFolder = "/home/tqichen/codespace/FCCStationPackingDeliverable";  
        String interferencesConfigFoldername ="/home/tqichen/codespace/FCCStationPackingDeliverable/021814SC3M";
        DataManager dm = new DataManager();
        ManagerBundle bundle = dm.getData(interferencesConfigFoldername);        
        StationPackingInstance packingInstance = EncodedInstanceToCNFConverter.getInstanceFromSQLString(UHF_only_sql_string, interferencesConfigFolder, dm).getFirst();

//        Set<Integer> VHFchannels = new HashSet<Integer>();
//        for (int i=2; i<=13; i++) {
//            VHFchannels.add(i);
//        }
//
//        Map<Station, Set<Integer>> newDomains = new HashMap<Station, Set<Integer>>();
//        Map<Station, Set<Integer>> domains = packingInstance.getDomains();
//
//        for (Station s : domains.keySet()) {
//            Set<Integer> dom = Sets.intersection(domains.get(s), VHFchannels); // Restrict domain to VHF only
//            if (!dom.isEmpty()) {
//                newDomains.put(s, dom);
//            }
//        }
//        packingInstance = new StationPackingInstance(newDomains, packingInstance.getPreviousAssignment());
        
        System.out.println("Num stations: " +packingInstance.getStations().size());

        Station station = Lists.newArrayList(packingInstance.getStations()).get(0);
        
        System.out.println("Target station: " +station);
        
        // Get SAT solver.
        String claspLibraryPath = "/home/tqichen/codespace/SATFC/SATsolvers/clasp/jna/libjnaclasp.so";
        ISATSolver satSolver = new ClaspSATSolver(claspLibraryPath, ClaspLibSATSolverParameters.ALL_CONFIG_11_13);

        // Get SAT encoder.
        ISATEncoder satEncoder = new SATCompressor(bundle.getConstraintManager());

        // Create MBoundModelCountSolver
        MBoundModelCountSolver mboundSolver = new MBoundModelCountSolver(satEncoder, satSolver, 8);

        Long begin = System.currentTimeMillis();
        
        Double stationCount = mboundSolver.countSatisfiablePackingsContainingStation(packingInstance, station, 0);
        
        Long stationEnd = System.currentTimeMillis();
        
        Double totalCount = mboundSolver.countSatisfiablePackings(packingInstance, 0);
        
        Long totalEnd = System.currentTimeMillis();
        
        
        System.out.println("Time for contain-station count: " + (stationEnd-begin)/1000);
        System.out.println("Time for total count: " + (totalEnd - stationEnd)/1000);
        
        System.out.println("Count with station vs. Total Count: " +stationCount+ "/" +totalCount+ "=" +stationCount/totalCount);

    }

}
